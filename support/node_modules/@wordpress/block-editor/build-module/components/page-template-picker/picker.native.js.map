{"version":3,"sources":["@wordpress/block-editor/src/components/page-template-picker/picker.native.js"],"names":["useState","useEffect","useRef","useDispatch","useSelect","logUserEvent","userEvents","Animated","Dimensions","Keyboard","Button","Container","getDefaultTemplates","Preview","PICKER_HEIGHT_OFFSET","__experimentalPageTemplatePicker","templates","visible","editPost","select","getEditedPostAttribute","title","templatePreview","setTemplatePreview","pickerVisible","setPickerVisible","contentOpacity","Value","current","shouldShowPicker","startPickerAnimation","addListener","onKeyboardDidShow","onKeyboardDidHide","removeListener","windowHeight","get","height","onApply","name","blocks","editorSessionTemplateApply","template","key","undefined","isVisible","timing","toValue","duration","useNativeDriver","start","opacity","map","icon","editorSessionTemplatePreview"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useState, useEffect, useRef } from '@wordpress/element';\nimport { useDispatch, useSelect } from '@wordpress/data';\n\n/**\n * External dependencies\n */\nimport { logUserEvent, userEvents } from 'react-native-gutenberg-bridge';\nimport { Animated, Dimensions, Keyboard } from 'react-native';\n\n/**\n * Internal dependencies\n */\nimport Button from './button';\nimport Container from './container';\nimport getDefaultTemplates from './default-templates';\nimport Preview from './preview';\n\n// Used to hide the picker if there's no enough space in the window\nconst PICKER_HEIGHT_OFFSET = 150;\n\nconst __experimentalPageTemplatePicker = ( {\n\ttemplates = getDefaultTemplates(),\n\tvisible,\n} ) => {\n\tconst { editPost } = useDispatch( 'core/editor' );\n\tconst { title } = useSelect( ( select ) => {\n\t\tconst { getEditedPostAttribute } = select( 'core/editor' );\n\n\t\treturn {\n\t\t\ttitle: getEditedPostAttribute( 'title' ),\n\t\t};\n\t} );\n\n\tconst [ templatePreview, setTemplatePreview ] = useState();\n\tconst [ pickerVisible, setPickerVisible ] = useState( visible );\n\tconst contentOpacity = useRef( new Animated.Value( 0 ) ).current;\n\n\tuseEffect( () => {\n\t\tif ( shouldShowPicker() && visible && ! pickerVisible ) {\n\t\t\tsetPickerVisible( true );\n\t\t}\n\t\tstartPickerAnimation( visible );\n\n\t\tKeyboard.addListener( 'keyboardDidShow', onKeyboardDidShow );\n\t\tKeyboard.addListener( 'keyboardDidHide', onKeyboardDidHide );\n\n\t\treturn () => {\n\t\t\tKeyboard.removeListener( 'keyboardDidShow', onKeyboardDidShow );\n\t\t\tKeyboard.removeListener( 'keyboardDidHide', onKeyboardDidHide );\n\t\t};\n\t}, [ visible ] );\n\n\tconst onKeyboardDidShow = () => {\n\t\tif ( visible ) {\n\t\t\tstartPickerAnimation( shouldShowPicker() );\n\t\t}\n\t};\n\n\tconst onKeyboardDidHide = () => {\n\t\tif ( visible ) {\n\t\t\tsetPickerVisible( true );\n\t\t\tstartPickerAnimation( true );\n\t\t}\n\t};\n\n\tconst shouldShowPicker = () => {\n\t\t// On smaller devices on landscape we hide the picker\n\t\t// so it doesn't overlap with the editor's content\n\t\tconst windowHeight = Dimensions.get( 'window' ).height;\n\t\treturn PICKER_HEIGHT_OFFSET < windowHeight / 3;\n\t};\n\n\tconst onApply = () => {\n\t\teditPost( {\n\t\t\ttitle: title || templatePreview.name,\n\t\t\tblocks: templatePreview.blocks,\n\t\t} );\n\t\tlogUserEvent( userEvents.editorSessionTemplateApply, {\n\t\t\ttemplate: templatePreview.key,\n\t\t} );\n\t\tsetTemplatePreview( undefined );\n\t};\n\n\tconst startPickerAnimation = ( isVisible ) => {\n\t\tAnimated.timing( contentOpacity, {\n\t\t\ttoValue: isVisible ? 1 : 0,\n\t\t\tduration: 300,\n\t\t\tuseNativeDriver: true,\n\t\t} ).start( () => {\n\t\t\tif ( ! isVisible ) {\n\t\t\t\tsetPickerVisible( isVisible );\n\t\t\t}\n\t\t} );\n\t};\n\n\tif ( ! pickerVisible ) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<Animated.View style={ [ { opacity: contentOpacity } ] }>\n\t\t\t<Container>\n\t\t\t\t{ templates.map( ( template ) => (\n\t\t\t\t\t<Button\n\t\t\t\t\t\tkey={ template.key }\n\t\t\t\t\t\ticon={ template.icon }\n\t\t\t\t\t\tlabel={ template.name }\n\t\t\t\t\t\tonPress={ () => {\n\t\t\t\t\t\t\tlogUserEvent(\n\t\t\t\t\t\t\t\tuserEvents.editorSessionTemplatePreview,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttemplate: template.key,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tsetTemplatePreview( template );\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t) ) }\n\t\t\t</Container>\n\t\t\t<Preview\n\t\t\t\ttemplate={ templatePreview }\n\t\t\t\tonDismiss={ () => setTemplatePreview( undefined ) }\n\t\t\t\tonApply={ onApply }\n\t\t\t/>\n\t\t</Animated.View>\n\t);\n};\n\nexport default __experimentalPageTemplatePicker;\n"]}