{"version":3,"sources":["@wordpress/block-editor/src/components/block-list/block.js"],"names":["BlockListBlockContext","BlockListBlock","mode","isFocusMode","isLocked","clientId","rootClientId","isSelected","isMultiSelected","isPartOfMultiSelection","isFirstMultiSelected","isLastMultiSelected","isTypingWithinBlock","isAncestorOfSelectedBlock","isSelectionEnabled","className","name","isValid","attributes","wrapperProps","setAttributes","onReplace","onInsertBlocksAfter","onMerge","toggleSelection","index","enableAnimation","isNavigationMode","isMultiSelecting","select","isDraggingBlocks","isBlockHighlighted","isDragging","isHighlighted","hasError","setErrorState","onBlockError","blockType","lightBlockWrapper","isUnregisteredBlock","getEditWrapperProps","generatedClassName","customClassName","wrapperClassName","blockEdit","undefined","display","value","blockTitle","title","memoizedValue","Object","values","applyWithSelect","isLargeViewport","isBlockSelected","isAncestorMultiSelected","isBlockMultiSelected","isFirstMultiSelectedBlock","getLastMultiSelectedBlockClientId","isTyping","getBlockMode","getSettings","hasSelectedInnerBlock","getTemplateLock","__unstableGetBlockWithoutInnerBlocks","block","focusMode","isRTL","templateLock","checkDeep","applyWithDispatch","dispatch","ownProps","updateBlockAttributes","insertBlocks","mergeBlocks","replaceBlocks","__unstableMarkLastChangeAsPersistent","newAttributes","onInsertBlocks","blocks","getBlockIndex","forward","getPreviousBlockClientId","getNextBlockClientId","nextBlockClientId","previousBlockClientId","indexToSelect","initialPosition","length","selectionEnabled","pure"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { useState, createContext, useMemo } from '@wordpress/element';\nimport {\n\tgetBlockType,\n\tgetSaveElement,\n\tisReusableBlock,\n\tisUnmodifiedDefaultBlock,\n\tgetUnregisteredTypeHandlerName,\n\thasBlockSupport,\n\tgetBlockDefaultClassName,\n} from '@wordpress/blocks';\nimport { withFilters } from '@wordpress/components';\nimport { withDispatch, withSelect, useSelect } from '@wordpress/data';\nimport { withViewportMatch } from '@wordpress/viewport';\nimport { compose, pure, ifCondition } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport BlockEdit from '../block-edit';\nimport BlockInvalidWarning from './block-invalid-warning';\nimport BlockCrashWarning from './block-crash-warning';\nimport BlockCrashBoundary from './block-crash-boundary';\nimport BlockHtml from './block-html';\nimport { Block } from './block-wrapper';\n\nexport const BlockListBlockContext = createContext();\n\nfunction BlockListBlock( {\n\tmode,\n\tisFocusMode,\n\tisLocked,\n\tclientId,\n\trootClientId,\n\tisSelected,\n\tisMultiSelected,\n\tisPartOfMultiSelection,\n\tisFirstMultiSelected,\n\tisLastMultiSelected,\n\tisTypingWithinBlock,\n\tisAncestorOfSelectedBlock,\n\tisSelectionEnabled,\n\tclassName,\n\tname,\n\tisValid,\n\tattributes,\n\twrapperProps,\n\tsetAttributes,\n\tonReplace,\n\tonInsertBlocksAfter,\n\tonMerge,\n\ttoggleSelection,\n\tindex,\n\tenableAnimation,\n\tisNavigationMode,\n\tisMultiSelecting,\n} ) {\n\t// In addition to withSelect, we should favor using useSelect in this\n\t// component going forward to avoid leaking new props to the public API\n\t// (editor.BlockListBlock filter)\n\tconst { isDragging, isHighlighted } = useSelect( ( select ) => {\n\t\tconst { isDraggingBlocks, isBlockHighlighted } = select(\n\t\t\t'core/block-editor'\n\t\t);\n\t\treturn {\n\t\t\tisDragging: isDraggingBlocks(),\n\t\t\tisHighlighted: isBlockHighlighted( clientId ),\n\t\t};\n\t}, [] );\n\n\t// Handling the error state\n\tconst [ hasError, setErrorState ] = useState( false );\n\tconst onBlockError = () => setErrorState( true );\n\n\tconst blockType = getBlockType( name );\n\tconst lightBlockWrapper = hasBlockSupport(\n\t\tblockType,\n\t\t'lightBlockWrapper',\n\t\tfalse\n\t);\n\tconst isUnregisteredBlock = name === getUnregisteredTypeHandlerName();\n\n\t// Determine whether the block has props to apply to the wrapper.\n\tif ( blockType.getEditWrapperProps ) {\n\t\twrapperProps = {\n\t\t\t...wrapperProps,\n\t\t\t...blockType.getEditWrapperProps( attributes ),\n\t\t};\n\t}\n\n\tconst generatedClassName =\n\t\tlightBlockWrapper && hasBlockSupport( blockType, 'className', true )\n\t\t\t? getBlockDefaultClassName( name )\n\t\t\t: null;\n\tconst customClassName = lightBlockWrapper ? attributes.className : null;\n\n\t// The wp-block className is important for editor styles.\n\t// Generate the wrapper class names handling the different states of the\n\t// block.\n\tconst wrapperClassName = classnames(\n\t\tgeneratedClassName,\n\t\tcustomClassName,\n\t\t'block-editor-block-list__block',\n\t\t{\n\t\t\t'has-warning': ! isValid || !! hasError || isUnregisteredBlock,\n\t\t\t'is-selected': isSelected,\n\t\t\t'is-highlighted': isHighlighted,\n\t\t\t'is-multi-selected': isMultiSelected,\n\t\t\t'is-reusable': isReusableBlock( blockType ),\n\t\t\t'is-dragging':\n\t\t\t\tisDragging && ( isSelected || isPartOfMultiSelection ),\n\t\t\t'is-typing': isTypingWithinBlock,\n\t\t\t'is-focused':\n\t\t\t\tisFocusMode && ( isSelected || isAncestorOfSelectedBlock ),\n\t\t\t'is-focus-mode': isFocusMode,\n\t\t\t'has-child-selected': isAncestorOfSelectedBlock,\n\t\t},\n\t\tclassName\n\t);\n\n\t// We wrap the BlockEdit component in a div that hides it when editing in\n\t// HTML mode. This allows us to render all of the ancillary pieces\n\t// (InspectorControls, etc.) which are inside `BlockEdit` but not\n\t// `BlockHTML`, even in HTML mode.\n\tlet blockEdit = (\n\t\t<BlockEdit\n\t\t\tname={ name }\n\t\t\tisSelected={ isSelected }\n\t\t\tattributes={ attributes }\n\t\t\tsetAttributes={ setAttributes }\n\t\t\tinsertBlocksAfter={ isLocked ? undefined : onInsertBlocksAfter }\n\t\t\tonReplace={ isLocked ? undefined : onReplace }\n\t\t\tmergeBlocks={ isLocked ? undefined : onMerge }\n\t\t\tclientId={ clientId }\n\t\t\tisSelectionEnabled={ isSelectionEnabled }\n\t\t\ttoggleSelection={ toggleSelection }\n\t\t/>\n\t);\n\n\tif ( mode !== 'visual' ) {\n\t\tblockEdit = <div style={ { display: 'none' } }>{ blockEdit }</div>;\n\t}\n\n\tconst value = {\n\t\tclientId,\n\t\trootClientId,\n\t\tisSelected,\n\t\tisFirstMultiSelected,\n\t\tisLastMultiSelected,\n\t\tisMultiSelecting,\n\t\tisNavigationMode,\n\t\tisPartOfMultiSelection,\n\t\tenableAnimation,\n\t\tindex,\n\t\tclassName: wrapperClassName,\n\t\tisLocked,\n\t\tname,\n\t\tmode,\n\t\tblockTitle: blockType.title,\n\t\twrapperProps,\n\t};\n\tconst memoizedValue = useMemo( () => value, Object.values( value ) );\n\n\treturn (\n\t\t<BlockListBlockContext.Provider value={ memoizedValue }>\n\t\t\t<BlockCrashBoundary onError={ onBlockError }>\n\t\t\t\t{ isValid && lightBlockWrapper && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t{ blockEdit }\n\t\t\t\t\t\t{ mode === 'html' && (\n\t\t\t\t\t\t\t<Block.div __unstableIsHtml>\n\t\t\t\t\t\t\t\t<BlockHtml clientId={ clientId } />\n\t\t\t\t\t\t\t</Block.div>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</>\n\t\t\t\t) }\n\t\t\t\t{ isValid && ! lightBlockWrapper && (\n\t\t\t\t\t<Block.div { ...wrapperProps }>\n\t\t\t\t\t\t{ blockEdit }\n\t\t\t\t\t\t{ mode === 'html' && (\n\t\t\t\t\t\t\t<BlockHtml clientId={ clientId } />\n\t\t\t\t\t\t) }\n\t\t\t\t\t</Block.div>\n\t\t\t\t) }\n\t\t\t\t{ ! isValid && (\n\t\t\t\t\t<Block.div>\n\t\t\t\t\t\t<BlockInvalidWarning clientId={ clientId } />\n\t\t\t\t\t\t<div>{ getSaveElement( blockType, attributes ) }</div>\n\t\t\t\t\t</Block.div>\n\t\t\t\t) }\n\t\t\t</BlockCrashBoundary>\n\t\t\t{ !! hasError && (\n\t\t\t\t<Block.div>\n\t\t\t\t\t<BlockCrashWarning />\n\t\t\t\t</Block.div>\n\t\t\t) }\n\t\t</BlockListBlockContext.Provider>\n\t);\n}\n\nconst applyWithSelect = withSelect(\n\t( select, { clientId, rootClientId, isLargeViewport } ) => {\n\t\tconst {\n\t\t\tisBlockSelected,\n\t\t\tisAncestorMultiSelected,\n\t\t\tisBlockMultiSelected,\n\t\t\tisFirstMultiSelectedBlock,\n\t\t\tgetLastMultiSelectedBlockClientId,\n\t\t\tisTyping,\n\t\t\tgetBlockMode,\n\t\t\tisSelectionEnabled,\n\t\t\tgetSettings,\n\t\t\thasSelectedInnerBlock,\n\t\t\tgetTemplateLock,\n\t\t\t__unstableGetBlockWithoutInnerBlocks,\n\t\t\tisNavigationMode,\n\t\t} = select( 'core/block-editor' );\n\t\tconst block = __unstableGetBlockWithoutInnerBlocks( clientId );\n\t\tconst isSelected = isBlockSelected( clientId );\n\t\tconst { focusMode, isRTL } = getSettings();\n\t\tconst templateLock = getTemplateLock( rootClientId );\n\t\tconst checkDeep = true;\n\n\t\t// \"ancestor\" is the more appropriate label due to \"deep\" check\n\t\tconst isAncestorOfSelectedBlock = hasSelectedInnerBlock(\n\t\t\tclientId,\n\t\t\tcheckDeep\n\t\t);\n\n\t\t// The fallback to `{}` is a temporary fix.\n\t\t// This function should never be called when a block is not present in\n\t\t// the state. It happens now because the order in withSelect rendering\n\t\t// is not correct.\n\t\tconst { name, attributes, isValid } = block || {};\n\n\t\t// Do not add new properties here, use `useSelect` instead to avoid\n\t\t// leaking new props to the public API (editor.BlockListBlock filter).\n\t\treturn {\n\t\t\tisMultiSelected: isBlockMultiSelected( clientId ),\n\t\t\tisPartOfMultiSelection:\n\t\t\t\tisBlockMultiSelected( clientId ) ||\n\t\t\t\tisAncestorMultiSelected( clientId ),\n\t\t\tisFirstMultiSelected: isFirstMultiSelectedBlock( clientId ),\n\t\t\tisLastMultiSelected:\n\t\t\t\tgetLastMultiSelectedBlockClientId() === clientId,\n\n\t\t\t// We only care about this prop when the block is selected\n\t\t\t// Thus to avoid unnecessary rerenders we avoid updating the prop if\n\t\t\t// the block is not selected.\n\t\t\tisTypingWithinBlock:\n\t\t\t\t( isSelected || isAncestorOfSelectedBlock ) && isTyping(),\n\n\t\t\tmode: getBlockMode( clientId ),\n\t\t\tisSelectionEnabled: isSelectionEnabled(),\n\t\t\tisLocked: !! templateLock,\n\t\t\tisFocusMode: focusMode && isLargeViewport,\n\t\t\tisNavigationMode: isNavigationMode(),\n\t\t\tisRTL,\n\n\t\t\t// Users of the editor.BlockListBlock filter used to be able to\n\t\t\t// access the block prop.\n\t\t\t// Ideally these blocks would rely on the clientId prop only.\n\t\t\t// This is kept for backward compatibility reasons.\n\t\t\tblock,\n\n\t\t\tname,\n\t\t\tattributes,\n\t\t\tisValid,\n\t\t\tisSelected,\n\t\t\tisAncestorOfSelectedBlock,\n\t\t};\n\t}\n);\n\nconst applyWithDispatch = withDispatch( ( dispatch, ownProps, { select } ) => {\n\tconst {\n\t\tupdateBlockAttributes,\n\t\tinsertBlocks,\n\t\tmergeBlocks,\n\t\treplaceBlocks,\n\t\ttoggleSelection,\n\t\t__unstableMarkLastChangeAsPersistent,\n\t} = dispatch( 'core/block-editor' );\n\n\t// Do not add new properties here, use `useDispatch` instead to avoid\n\t// leaking new props to the public API (editor.BlockListBlock filter).\n\treturn {\n\t\tsetAttributes( newAttributes ) {\n\t\t\tconst { clientId } = ownProps;\n\t\t\tupdateBlockAttributes( clientId, newAttributes );\n\t\t},\n\t\tonInsertBlocks( blocks, index ) {\n\t\t\tconst { rootClientId } = ownProps;\n\t\t\tinsertBlocks( blocks, index, rootClientId );\n\t\t},\n\t\tonInsertBlocksAfter( blocks ) {\n\t\t\tconst { clientId, rootClientId } = ownProps;\n\t\t\tconst { getBlockIndex } = select( 'core/block-editor' );\n\t\t\tconst index = getBlockIndex( clientId, rootClientId );\n\t\t\tinsertBlocks( blocks, index + 1, rootClientId );\n\t\t},\n\t\tonMerge( forward ) {\n\t\t\tconst { clientId } = ownProps;\n\t\t\tconst { getPreviousBlockClientId, getNextBlockClientId } = select(\n\t\t\t\t'core/block-editor'\n\t\t\t);\n\n\t\t\tif ( forward ) {\n\t\t\t\tconst nextBlockClientId = getNextBlockClientId( clientId );\n\t\t\t\tif ( nextBlockClientId ) {\n\t\t\t\t\tmergeBlocks( clientId, nextBlockClientId );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst previousBlockClientId = getPreviousBlockClientId(\n\t\t\t\t\tclientId\n\t\t\t\t);\n\t\t\t\tif ( previousBlockClientId ) {\n\t\t\t\t\tmergeBlocks( previousBlockClientId, clientId );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonReplace( blocks, indexToSelect, initialPosition ) {\n\t\t\tif (\n\t\t\t\tblocks.length &&\n\t\t\t\t! isUnmodifiedDefaultBlock( blocks[ blocks.length - 1 ] )\n\t\t\t) {\n\t\t\t\t__unstableMarkLastChangeAsPersistent();\n\t\t\t}\n\t\t\treplaceBlocks(\n\t\t\t\t[ ownProps.clientId ],\n\t\t\t\tblocks,\n\t\t\t\tindexToSelect,\n\t\t\t\tinitialPosition\n\t\t\t);\n\t\t},\n\t\ttoggleSelection( selectionEnabled ) {\n\t\t\ttoggleSelection( selectionEnabled );\n\t\t},\n\t};\n} );\n\nexport default compose(\n\tpure,\n\twithViewportMatch( { isLargeViewport: 'medium' } ),\n\tapplyWithSelect,\n\tapplyWithDispatch,\n\t// block is sometimes not mounted at the right time, causing it be undefined\n\t// see issue for more info\n\t// https://github.com/WordPress/gutenberg/issues/17013\n\tifCondition( ( { block } ) => !! block ),\n\twithFilters( 'editor.BlockListBlock' )\n)( BlockListBlock );\n"]}