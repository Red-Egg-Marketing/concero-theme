{"version":3,"sources":["@wordpress/block-editor/src/components/page-template-picker/picker.native.js"],"names":["PICKER_HEIGHT_OFFSET","__experimentalPageTemplatePicker","templates","visible","editPost","select","getEditedPostAttribute","title","templatePreview","setTemplatePreview","pickerVisible","setPickerVisible","contentOpacity","Animated","Value","current","shouldShowPicker","startPickerAnimation","Keyboard","addListener","onKeyboardDidShow","onKeyboardDidHide","removeListener","windowHeight","Dimensions","get","height","onApply","name","blocks","userEvents","editorSessionTemplateApply","template","key","undefined","isVisible","timing","toValue","duration","useNativeDriver","start","opacity","map","icon","editorSessionTemplatePreview"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useState, useEffect, useRef } from '@wordpress/element';\nimport { useDispatch, useSelect } from '@wordpress/data';\n\n/**\n * External dependencies\n */\nimport { logUserEvent, userEvents } from 'react-native-gutenberg-bridge';\nimport { Animated, Dimensions, Keyboard } from 'react-native';\n\n/**\n * Internal dependencies\n */\nimport Button from './button';\nimport Container from './container';\nimport getDefaultTemplates from './default-templates';\nimport Preview from './preview';\n\n// Used to hide the picker if there's no enough space in the window\nconst PICKER_HEIGHT_OFFSET = 150;\n\nconst __experimentalPageTemplatePicker = ( {\n\ttemplates = getDefaultTemplates(),\n\tvisible,\n} ) => {\n\tconst { editPost } = useDispatch( 'core/editor' );\n\tconst { title } = useSelect( ( select ) => {\n\t\tconst { getEditedPostAttribute } = select( 'core/editor' );\n\n\t\treturn {\n\t\t\ttitle: getEditedPostAttribute( 'title' ),\n\t\t};\n\t} );\n\n\tconst [ templatePreview, setTemplatePreview ] = useState();\n\tconst [ pickerVisible, setPickerVisible ] = useState( visible );\n\tconst contentOpacity = useRef( new Animated.Value( 0 ) ).current;\n\n\tuseEffect( () => {\n\t\tif ( shouldShowPicker() && visible && ! pickerVisible ) {\n\t\t\tsetPickerVisible( true );\n\t\t}\n\t\tstartPickerAnimation( visible );\n\n\t\tKeyboard.addListener( 'keyboardDidShow', onKeyboardDidShow );\n\t\tKeyboard.addListener( 'keyboardDidHide', onKeyboardDidHide );\n\n\t\treturn () => {\n\t\t\tKeyboard.removeListener( 'keyboardDidShow', onKeyboardDidShow );\n\t\t\tKeyboard.removeListener( 'keyboardDidHide', onKeyboardDidHide );\n\t\t};\n\t}, [ visible ] );\n\n\tconst onKeyboardDidShow = () => {\n\t\tif ( visible ) {\n\t\t\tstartPickerAnimation( shouldShowPicker() );\n\t\t}\n\t};\n\n\tconst onKeyboardDidHide = () => {\n\t\tif ( visible ) {\n\t\t\tsetPickerVisible( true );\n\t\t\tstartPickerAnimation( true );\n\t\t}\n\t};\n\n\tconst shouldShowPicker = () => {\n\t\t// On smaller devices on landscape we hide the picker\n\t\t// so it doesn't overlap with the editor's content\n\t\tconst windowHeight = Dimensions.get( 'window' ).height;\n\t\treturn PICKER_HEIGHT_OFFSET < windowHeight / 3;\n\t};\n\n\tconst onApply = () => {\n\t\teditPost( {\n\t\t\ttitle: title || templatePreview.name,\n\t\t\tblocks: templatePreview.blocks,\n\t\t} );\n\t\tlogUserEvent( userEvents.editorSessionTemplateApply, {\n\t\t\ttemplate: templatePreview.key,\n\t\t} );\n\t\tsetTemplatePreview( undefined );\n\t};\n\n\tconst startPickerAnimation = ( isVisible ) => {\n\t\tAnimated.timing( contentOpacity, {\n\t\t\ttoValue: isVisible ? 1 : 0,\n\t\t\tduration: 300,\n\t\t\tuseNativeDriver: true,\n\t\t} ).start( () => {\n\t\t\tif ( ! isVisible ) {\n\t\t\t\tsetPickerVisible( isVisible );\n\t\t\t}\n\t\t} );\n\t};\n\n\tif ( ! pickerVisible ) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<Animated.View style={ [ { opacity: contentOpacity } ] }>\n\t\t\t<Container>\n\t\t\t\t{ templates.map( ( template ) => (\n\t\t\t\t\t<Button\n\t\t\t\t\t\tkey={ template.key }\n\t\t\t\t\t\ticon={ template.icon }\n\t\t\t\t\t\tlabel={ template.name }\n\t\t\t\t\t\tonPress={ () => {\n\t\t\t\t\t\t\tlogUserEvent(\n\t\t\t\t\t\t\t\tuserEvents.editorSessionTemplatePreview,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttemplate: template.key,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tsetTemplatePreview( template );\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t) ) }\n\t\t\t</Container>\n\t\t\t<Preview\n\t\t\t\ttemplate={ templatePreview }\n\t\t\t\tonDismiss={ () => setTemplatePreview( undefined ) }\n\t\t\t\tonApply={ onApply }\n\t\t\t/>\n\t\t</Animated.View>\n\t);\n};\n\nexport default __experimentalPageTemplatePicker;\n"]}